# Kickstart file automatically generated by anaconda.

#version=DEVEL
install
url --url=http://mirror.centos.org/centos/6.5/os/i386
# for rapid install use text mode
text
lang en_EN.UTF-8
keyboard en-latin9
network --onboot yes --device eth0 --bootproto dhcp --ipv6 auto
rootpw --iscrypted $1$0deOQfp9$kZM4yrnZEczFwKfAoWbrh/
firewall --disable
reboot
authconfig --enableshadow --passalgo=sha512
selinux --disabled
timezone --utc Europe/London
bootloader --location=mbr --driveorder=sda --append="crashkernel=auto rhgb quiet"
# The following is the partition information you requested
# Note that any partitions you deleted are not expressed
# here so unless you clear all partitions first, this is
# not guaranteed to work
clearpart --all --initlabel

part /boot --fstype=ext4 --size=500
part pv.008002 --grow --size=1

volgroup vg_serveur1 --pesize=4096 pv.008002
logvol / --fstype=ext4 --name=lv_root --vgname=vg_serveur1 --grow --size=1024 --maxsize=51200
logvol swap --name=lv_swap --vgname=vg_serveur1 --grow --size=4032 --maxsize=4032

repo --name="CentOS base" --baseurl=http://mirror.centos.org/centos/6.5/os/i386 --cost=100
repo --name="CentOS Contrib" --baseurl=http://mirror.centos.org/centos/6.5/contrib/i386 --cost=1000
repo --name="CentOS Plus" --baseurl=http://mirror.centos.org/centos/6.5/centosplus/i386 --cost=1000
repo --name="CentOS Updates" --baseurl=http://mirror.centos.org/centos/6.5/updates/i386 --cost=1000
repo --name="CentOs Extras" --baseurl=http://mirror.centos.org/centos/6.5/extras/i386 --cost=1000
repo --name="Epel" --baseurl=http://download.fedoraproject.org/pub/epel/6/i386 --cost=1000

%packages
sudo
wget
vim
make
zip
unzip
git
chkconfig
ld-linux.so.2
libbz2.so.1
libdb-4.7.so
libgd.so.2
httpd
php
php-suhosin
php-devel
php-gd
php-mbstring
php-mcrypt
php-intl
php-imap
php-mysql
php-xml
php-xmlrpc
curl
curl-devel
perl-libwww-perl
libxml2
libxml2-devel
mysql-server
zip
webalizer
gcc
gcc-c++
httpd-devel
at
make
mysql-devel
bzip2-devel
postfix
postfix-perl-scripts
bash-completion
dovecot
dovecot-mysql
dovecot-pigeonhole
mysql-server
proftpd
proftpd-mysql
bind
bind-utils
bind-libs
%end

%post
yum -y update
touch /root/zpx-installer.sh
chmod 777 /root/zpx-installer.sh
cat > /root/zpx-installer.sh <<EOF
#!/bin/bash
cd /root
wget https://raw.github.com/andykimpe/installers/master/install/beta/postinstall/Centos_6_5_en_posintstall_kickstart.sh
chmod +x Centos_6_5_en_posintstall_kickstart.sh
./Centos_6_5_en_posintstall_kickstart.sh
#default root password password
echo "root:password" | chpasswd
EOF
cat <<EOM >> /etc/rc.local
        if [ ! -d "/var/zpanel" ]; then
                nohup /root/zpx-installer.sh & > /dev/null
        fi
EOM
eject cdrom
exit
%end
